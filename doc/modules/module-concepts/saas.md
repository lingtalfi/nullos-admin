Saas
==========
2016-12-24 -- 2016-12-25


Services Automated Attachment System.


- [Saas](#saas)
- [The problem](#the-problem)
- [The solution](#the-solution)
- [The implementation](#the-implementation)
 * [Example](#example)


The problem
==============
A module can be a stand-alone piece of code, but it can also:

- provide one or more services for the other modules (in which case it is called a **provider module**)
- subscribe to one or more services from one or more other modules (in which case it is called a **subscriber module**)

Note: a module can be both a provider and a subscriber at the same time.



What happens when a subscriber module is activated and the provider is already in place?

Well, the subscriber should subscribe to the provider module. Fine.


But now, what happens when the subscriber module is activated, but the provider is not installed.

Umm, well just ignore the subscription for this module, not big deal, right?

Okay, but then imagine the provider module is installed afterwards...

The problem is this:

- if the provider module is installed afterwards, how can the subscriber module subscribe?


Saas offers a solution to this problem.



The solution
================

The solution provided by saas is actually quite basic, but it relies on convenient conventions to help
with the implementation.

Here it is.

So there are two phases:

- service offer 
- service search
 
When a provider module is activated, it starts a **service offer** phase: basically saying: 
"Hey, I offer this new service, are you interested?".
  
Interested subscriber modules will obviously take the opportunity to subscribe.
  
Then the **service search** phase occurs when a subscriber module is activated, basically
asking the question to every module: "Hey, do you have this service?".

In case of a positive answer, the subscription occurs.



The implementation
=====================
2016-12-25
 
 
For each module, the system needs to know:
- the **service ids** the module wants to subscribe to
- the services that the module provides
    


A **service id** is the name of the module, followed by a dot, followed by the service method name (i.e. MyModule.theMethod).

To subscribe to another module's service, create an Installer class if necessary,
and make it implement the ModuleSaasInterface interface.


You then must provide the **getSubscriberServiceIds** method, which returns the 
array of service ids to which the module subscribes.


Now to provide services, a module uses the "Services" class (i.e. MyModuleServices).

Every method inside this class represents a service, it must be "public static",
and all the subscribers MUST use exactly the same definition, but from their "Module" class (i.e. MyModuleModule).
    Remember that the "Module" class is the ambassador of the module: it basically hooks itself to other modules.



Example
--------------
Here is an imaginary example that illustrates what have just been discussed:

```php
// subscriber side
class MySubscriberInstaller extends ModuleInstaller implements ModuleSaasInterface {
    public function getSubscriberServiceIds(){
        return [
            'SomeProvider.doYourHomework',
        ];
    }
}

class MySubscriberModule 
{
    public static function doYourHomework($time=6){
        echo "foo";
    }
}

// provider side
class SomeProviderServices {
    public static function doYourHomework($time=6){
        // this code will be generated by saas, it contains all the hookings, for instance:
        // \MySubscriber\MySubscriberModule::doYourHomework($time);
    }
}

```

The code above will work, all the hookings will be done automatically by the SaasInstaller
when installing either the MySubscriber module and/or the SomeProvider module.

Note the SaasInstaller works only if the target module is installed, or is a core module (i.e. it doesn't work if the module
is uninstalled).




